using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace UnitTests
{
    [TestClass]
    public class KeccakTest
    {
        public KeccakTest()
        {
        }

        [TestMethod]
        public void KeccakTestMethod()
        {
            CrypTool.PluginBase.ICrypComponent pluginInstance = TestHelpers.GetPluginInstance("Keccak");
            PluginTestScenario keccakDefaultScenario = new PluginTestScenario(
                pluginInstance, new[] { "InputStream", ".KECCAKFunction", ".OutputLength" }, new[] { "OutputStream" });
            PluginTestScenario keccakSHAScenario = new PluginTestScenario(
                pluginInstance, new[] { "InputStream", ".KECCAKFunction" }, new[] { "OutputStream" });
            PluginTestScenario keccakSHAWithDomainSeparationScenario = new PluginTestScenario(
                pluginInstance, new[] { "InputStream", ".KECCAKFunction", ".SuffixBits" }, new[] { "OutputStream" });
            object[] output;

            int keccakDefaultOutputLength = 4096;
            foreach (TestVector vector in KeccakDefaultTestvectors)
            {
                output = keccakDefaultScenario.GetOutputs(new object[] { vector.input.HexToStream(), vector.mode, keccakDefaultOutputLength });
                Assert.AreEqual(vector.output.ToUpper(), output[0].ToHex(), "Unexpected value in Keccak test #" + vector.n + ".");
            }

            foreach (TestVector vector in SHA3_224TestVectors)
            {
                output = keccakSHAScenario.GetOutputs(new object[] { vector.input.HexToStream(), vector.mode });
                Assert.AreEqual(vector.output.ToUpper(), output[0].ToHex(), "Unexpected value in SHA3-224 test #" + vector.n + ".");
            }

            foreach (TestVector vector in SHA3_256TestVectors)
            {
                output = keccakSHAScenario.GetOutputs(new object[] { vector.input.HexToStream(), vector.mode });
                Assert.AreEqual(vector.output.ToUpper(), output[0].ToHex(), "Unexpected value in SHA3-256 test #" + vector.n + ".");
            }

            foreach (TestVector vector in SHA3_384TestVectors)
            {
                output = keccakSHAScenario.GetOutputs(new object[] { vector.input.HexToStream(), vector.mode });
                Assert.AreEqual(vector.output.ToUpper(), output[0].ToHex(), "Unexpected value in SHA3-384 test #" + vector.n + ".");
            }

            foreach (TestVector vector in SHA3_512TestVectors)
            {
                output = keccakSHAScenario.GetOutputs(new object[] { vector.input.HexToStream(), vector.mode });
                Assert.AreEqual(vector.output.ToUpper(), output[0].ToHex(), "Unexpected value in SHA3-512 test #" + vector.n + ".");
            }

            foreach (TestVector vector in SHAKE128TestVectors)
            {
                output = keccakSHAScenario.GetOutputs(new object[] { vector.input.HexToStream(), vector.mode });
                Assert.AreEqual(vector.output.ToUpper(), output[0].ToHex().Substring(0, 32), "Unexpected value in SHAKE128 test #" + vector.n + ".");
            }

            foreach (TestVector vector in SHAKE256TestVectors)
            {
                output = keccakSHAScenario.GetOutputs(new object[] { vector.input.HexToStream(), vector.mode });
                Assert.AreEqual(vector.output.ToUpper(), output[0].ToHex().Substring(0, 64), "Unexpected value in SHAKE256 test #" + vector.n + ".");
            }
        }

        private struct TestVector
        {
            public string input, output;
            public int n, mode;
        }

        //
        // Sources of the test vectors for Keccak (used in the keccakDefaultTestvectors and keccakSHATestvectors):
        // http://keccak.noekeon.org/files.html (Known-answer and Monte Carlo test results, Latest version (as updated for round 3))
        // direct link: http://keccak.noekeon.org/KeccakKAT-3.zip    
        private readonly TestVector[] KeccakDefaultTestvectors = new TestVector[] {
            /* ShortMsgKAT_0 */			
            new TestVector () { n=0, mode=0,	// 0 byte
			input="",
            output="6753E3380C09E385D0339EB6B050A68F66CFD60A73476E6FD6ADEB72F5EDD7C6F04A5D017A19CBE291935855B4860F69DF04C98AA78B407A9BA9826F7266EF14BA6D3F90C4FE154D27C2858EA6DB8C117411A1BC5C499410C391B298F37BF636B0F5C31DBD6487A7D3D8CF2A97B619697E66D894299B8B4D80E0498538E18544C3A2FA33F0BFB1CFEF8DA7875C4967F332C7FC93C050E81FB404F9A91503D6010EE16F50B4ED0BC563BA8431668B003D7E2E6F226CB7FA93BB2E132C861FDC2141457589A63ECF05481126A7C2DE941A2FDEC71CB70DE81887B9014223865E79C4FFE82DAE83C1FC484B9A07A7E52B135F4AE3A0E09247EA4E2625E9349B0AC73F24CB418DF6DCB49CA37860298ADA18AA23595B5096EF789DE3EDF3826817FFF4F71102A01E1D2599F2958D5C186F5B11F5FEEDB61BB732DBB42D18B1E77258A8F211BF95C9F47F19603EC419FF879AEA41A4811344D016BBC4F9496741C469CCA425C5BE73543219AF40796C0B9FF14AEAA70C5E22E4BB1346A3DDFEDD8A559104E4704F1227D42918AE3F7404FBF3C6340A486E776AABCC34190F87DA4BD954B83386255A0E34DF05CA2E781FAF6FE66475852481FCE20798A56629ABFAC408760CE64606008A3B568C88ABA1C6DF3381E0765567EA84B2CE4B441CF1EEFAA32125D5139361A632B3008566A2E8AF1055CB06AE462B6BF87B34A9770618E6",},
            new TestVector () { n=1, mode=0,	// 1 byte
			input="CC",
            output="56B97029B479FF5DD15F17D12983E3B835BB0531D9B8D49B103B025CA53F991741298E961D1FAD00FC365C7761BFB278AE473980D612C1629E075A3FDBAE7F82B0F0AF54DF187F358852E19EA4347CF5CEEA676A1DCE3A47447E237FD74204F9A4B7F7C9CC7CC8B865B1D554E2F5F4A8EE17DBDDE7267894558A20972C9EB6CF5F62CE9151437718ED4AFF08FA76D803806E6CE47D229AAE839369E31888B26429E27BC3756021CB51498BCF2527D4BB04838BC1CEED9985A2A66FF8CB8C2D58B7099304E7F9622C583B093024A5FCDE2BE781474C159DF24D77D328C298F5766A8A0DBF7AE790A509CCF59E0CACD0ABF21492E0095A87ECDB55990093917AAA96D7F68B7B859B8094AEC0DDB6FB352A6CC1F007FA988ED764F5D6F21F9D8ADE9CE7ACA4DE6570DA39D9ACCEB46D2582FA4C4231DE0B736FB341041D24CFAE6C0761F43A2CF7383F38742579218AFCAB53D2E6816640DE05644D877558E965B1A28406999F31CCC43AC0B02BC5448B66AD3B6F8DE04C0E25845C8671B6F0594909A057F17FD06031707C8B4599889C994A35C193DBF84A7A0919CD054F67CEB7965F420D02DA3477EFC8B55413C241ADCF71CB10FE7E3E720B8C1736837B06E4B27461B71C6CAC892437530BBFE05CF426272F80F11709B9DB964F5DEDAB9E757C2F7A972B6A4C2443B03AD787AB1E243660BCED739157A434800696841ACEA4",},
            new TestVector () { n=2, mode=0,	// 2 byte
			input="41FB",
            output="CBE96338DD8F04C0694299637AAB223B6D60560C6BED7F69923AEBB24FC61B84702403D39E7D081F7F7B714E3BA6E6221FE840F57A1E9BD775B90D59C9853695C2B11CD06F1054210D7D8155B908FF4EE14FDF859B6D5AA6BF76903BE0AF4A2FFD52B2B149DA32C8E372F51826D4CA7DCD6516D167A0621AA88986D19A524DD352B9CA08F341D2267671F45E05892E1A5C604BB721BC8952DAC20D559DC183656501CC34BC91E2AEA930716B20539131AC5F9AE0A630E3691ABE6E76935D21F99E3F2E531526360405004BD730388236A1197FE3715315E8CA40B4E5E6A07CAB434264515C26451A7C1387D776BC225B851E9F7807C24A23F42FB47EB29697F6CD80CDBFB79A39675092AB582C5A6BB3284CD72A889601DC2745153FAC80FF81C6648CB99FACFE51862EDC8B03C2C3BA5B83EB1D40D3937CAF3D8E511485051D3E5431A19C1571B52E796CF032162292ECF2B490CD97C3E2FC2CA339021533CD1AA1C5E8B3F803767AE7585999A2B7D70C7B34324B36399A87C3C73866741CBEF9355C1570309544697DF9A82DA28B6C5CE35556C5BEF4E0A24E62F95E543CD3FAD6D2DDEEA3950E72867D67A8DCD4B338FD8341583FE0E04FFF2D6ECDFCD4B41EB8434EE0E31F812B220494202FAB9FCBA09A9DD26B36637DF5607C6D7CBEDE04868A2D512D11A16C24C4B8D566CE63932B85E7E1A8648F58857629BDC2EE92",},
            new TestVector () { n=3, mode=0,	// 4 byte
			input="C1ECFDFC",
            output="968A76720A2FFF1AC9629CAC7752C0958B6E19BC79FA31F210244D486645798B55F52581855DA53A14139DD78E15F54C66BDE1BCC5674F46DE6164A86933B2CC99682F7118AF25B9034CDDAC018E6D02F3890FA581C79CAD5C6C2380A890EA470876E7BEDE8E8B78AA6F0CB271F54252DD018C7C9D393A06D60A78BE8A5014B89EAA282DFEC4E737E43A61CFAADE58F9BDDE9C6125DAF34350B2B4E320F35B62DD0675C0515B943630E3F63880423864DBD70814CC9373C521E8F29BB4138388C92C4B6437A65469902E706CCCE3777991A47C0EE9701217FB44CB02E674C7539E473D20352A7A875D6CF3A038E655D3D1A75852FC1859835CC181EF0C58B888A6673BB8275CFB9797F5E146A962D8DEB535FC7B166AF4FC95209A2DD4C515A0C04DDADFB77BA6B8DA76C9AE9CCE13538608603ED3550C685BACDC0A059F92DAD364F8A72DFAF52FAF43011C33B6A6235D9AC6611F346D955E1701F37713BB6F98A05337B1943556D497A4A686645FC359375408702EC45617C949D1209824E4627741CF2760E6AE84E0E1D395DA4DA5748D042BFF19351FF20092DF201AEAB4D6C603693E6AB01DABAF009A1C8A93E713DACD4A0D93695A2F6EF4E59AB9A140A100766B25B86CBB3632AA73FB16F47B9839E4D0E8736A0B81CDD923F0BE79C4C7AB1F7E1BE0ED5F079F6E04B979A567E81BC0C1A236E3DAA2754F195FF76261",},
            new TestVector () { n=5, mode=0,	// 8 byte
			input="4A4F202484512526",
            output="48772B84AC6DE16E5C5E7B2D5C30BC5019E18087117057397AAC182F868DB314C5E2F5E09A5A25964B0C597B1C51181F6DB6BC5E7712C9E7082D3584196AC0F38767112AAF6589A9EABEC354DE16007C2E39427BAAD5CF52822186F95993571CF89065E52C03B5003556133BC1BB49D542BFFD8C1C65FB3E86F27BF1B7D6B78A8CCF3F259943D6E5DC4B1138222CAEFC1D9FD2695D2AC96E313C31D50878B55B67FF5F9D73EF004B8E326AC17EEDE122F949697121802A15818981CFD6E24223391A3F6CA907B8C175D740607D6794499622187EC9C6CDC15868E4C412F5D890301777A38D6D55F11A3D3C23B4ACAC6ADA8FF808F3F6CE277ED851911D977ECEF917975463918E7DAF087A128E66D0C32C585B2B11FE3F9A6955C807E6814FB2EE8F7C256A3465310D61B5502CF5C437A14753EFCF8E4F07F971B0B47232004B5751F3FD13E402CF864536A6999D94FA8364F019C554F4F5394B55670B62CA9C6B90ED598A6503DC9B53899197C6B005B9209A3C9935D178E15AF31C681182C58A6F1CCC023C82ADF09DE62BED8A517778CF5336B6FD4F4C8CBE79A9F74DA589C898CAF39F89C77230265665A3B05E07AF5D475A91490E07ABDB72CBDDF6A962A226A02C8307F49327F3A3789DC02C4BD73653A22E8AA557B1B6DC118A84655BF58E0500076BBECA3662D3D8C8AFA9DEA411C0D1256AC7F9E3A3DA250B44536A",},
            new TestVector () { n=5, mode=0,	// 16 byte
			input="52A608AB21CCDD8A4457A57EDE782176",
            output="73BFBF058D089250115E868082E0AE0F8ACD78E9CCE6D7107140E4D6FC142C53CB548B0B37B643E3B4C1D93DE38EDA1D6E78D1033041C64A7A06ABB68238566E43A75087C4597467D7135242E3BCBF0DC5B14906D5128242C348191AAAF664041050C40230FBC6567E6C8579DA34D2133DF5A213BC73C8702E9B46411A9046589FEB8FE942BCF2DB74DB0ABDEF5D87AF13E10F8BF5615EAC6149F82B82FD5D3E31D1DF3EBF90F1EBD61D7C2E4CF598869EBF5A48DC22B2B3AAE1AA6B3E6E358161EBDB8D4888BA2A582C768521BD118562497CBDECFF26957F8A6425A1982B327E93B7489355C5F08A1348E47E4C7C9E037DEBE8E61EDF4F69C6BAB5148C9333BB851BC05F8F179000D2FB8C2D5FB5B137DF0D3196223A31055253C833F4689EE8A2A6DDE13C36DABE4162903F9C5A568B8671D8FF2D781F2CC0E459A6EE95BB03C88A8E5EDAC4D2F052108D1A9AA2CECE704C26DA2ED1F5DEEC8740847EF320B20283B6B26FEE0E673E986BB34DA6075F7FC48E3666C7C61BEFB7BBF9DD27CA16A402942B32FEB9B482FF5557A3D9B62BD1DFC257A3500C4E2DA4FA5398E331D3EF900AEDAB4C1EE802DBCE08D74065082B6D77E68849336F35BF8C4D0053B46705FAB40348F2B2E79D02B59E057421B517AA544B081CA47B128C63C2B603C25CA2EDE67D5382B72616BA0B507EBC8FF035E72F1EE048F16CC0CB342DEB11E1",},
            new TestVector () { n=6, mode=0,	// 32 byte
			input="9F2FCC7C90DE090D6B87CD7E9718C1EA6CB21118FC2D5DE9F97E5DB6AC1E9C10",
            output="2A24F96D9F5FC47CF4B7CF4DD136968B84051474EEF7E3E18D18B521BF902A4E9BD4B8EB574B4D441B72AAF7990076228EAD052507B6C88E298FDDE0E30BC1A9480BD8A78F344DB4A8520B940BAEC325A5778370825EEE1FB09436FAF2C67BA6B94B341BED52335718D0B9F7AFF77827E4CF598DBC5722AE9A1D4333FA61D6F7598C36F6BB28F48F0CE285DDEC4D17177AF7152A85BC877DF9C60401E32537AF04CD35DFAD848C81E4DDE15046AB61260C8CAA63195F8AFB66A6A4A5A5F581124FEF8CB88B74653ECAA72202F2EDD1CA423681324E2799755E04E55F380DA7133B9C2A2A55AF62B7E68A4612B6C849F18EDB5A856812122D53D06ED5885FB74524C6CE74881C85F756C7D0BDBE6EAC35235BD9036E12EB324935C45361A6911CB65D6C241BA86000F3ADAF36AAC7EFB840AB17E6F72E3D52C80DD905A3E2DB1750C9CA4F75D5284991E1E70A848BC1D284A37B9634CCB2BBC3076208A526B727FE5C37276676B49CBA4D2AB613DD20D4DC6A070F7118D0FF505E6AFCA1910B00BDDF151683AF676AFFAFF89F29481668746681EBBDC0305D912F1F5A55D6305A844C618353ED9BAEBFD8B446F1A71E5CA2897A31713E46153D4CF0D28DDED26CA4124B82D52A0945F4F814D06F1E2747558E08DEDAE3149E6666B072A02F83BAD945E2CF0C9BE61EA7E0747CA7CDAEC68AB3F6C991D17EA0847CD8DCF950647B",},
            new TestVector () { n=7, mode=0,	// 64 byte			
            input="E926AE8B0AF6E53176DBFFCC2A6B88C6BD765F939D3D178A9BDE9EF3AA131C61E31C1E42CDFAF4B4DCDE579A37E150EFBEF5555B4C1CB40439D835A724E2FAE7",
            output="510A9D662C2CA0A3E90A9893EEA5B6A64274C04B0D8A7AB9991E2FD5A1A98BBF3752AF65AFE8B27E1DC414C0197F1A6F487736F1AC5D4F32FDE6B780316482CA60A381B5493E96909FE708246C06FCF35EB30D6879AE7BEE42C63A124AD4BF67FA19564094E06466D235168CA5C08202F7F6073021734DD808DA40651BE189E6127B6C078588E11C88D945010E90AA8AF278622C8DEA9A10F62A186E3B750D623B92569A0F4194EE0CDF7CA6DA7C70333F042E170FA922602818FAF85EC79EAC10F2BABFF963835C194896ADA2017C8E936A6683DF1565CF0A0AAD045DF51AE7E81BAF521F6EBB0586631F7D19658AED7D827C2D0CA0A417BDE9FB8216D4781CFD35694D50B8DBE4AED50D598952FA70B84F1A2A04CC3167F6A8CF29641888CBF6D0786D47CCE11C5BC8CCE318D5ED2037C15C05F83274AAA55368C91B23B54911108138B888E2B3047F01A0B76D00C1CCE218ADE40F5252CDFE4D3B079461476534E88B7B566BE6CD887193E2B7457D388E226699162B4F3A30384EACFCBD9F09B6AC491ABD12690325F94DD3E703D1D1B19AAF64C0F56DDF25339473ECB315539DFC312B9F1D2899B26DF797D70808329A196F844217FA874C6AB598A6E905B868F9857BEAF8234EFC295A5FF44744B8F6EFEBF073A567C7DBFC222A1DD65C0A9F22F1C20FEA48922C572A9B07827AC14167C75A06A2800686BD76F217CB83",},
            new TestVector () { n=8, mode=0,	// 128 byte
			input="2B6DB7CED8665EBE9DEB080295218426BDAA7C6DA9ADD2088932CDFFBAA1C14129BCCDD70F369EFB149285858D2B1D155D14DE2FDB680A8B027284055182A0CAE275234CC9C92863C1B4AB66F304CF0621CD54565F5BFF461D3B461BD40DF28198E3732501B4860EADD503D26D6E69338F4E0456E9E9BAF3D827AE685FB1D817",
            output="DCAC84568F15CAC076854EA692DE95E473768A99DF9AC2328EE423D02EEB8EE8E1D1706213C4415DC7AAFA66476D8EBDDDD8BF39E1DE05CA76C36E7E975629331F3A33C3CA4091C82004E5891B7E276D4642EA61BDE021871C9B5C8CFA82144B7A4144B44EBE6093E95C59305FD36A8741C4F2DF65CB0B59F803CFDCF2CE4B8B54857A7F8AD8477A22CFFC07F4A5EF76996837C9B3F8FF25375E669E68FAEBED8AC79673860F45FD6E7EE7ED630CB8582785EED432AF1F4CA22F4FD4488DC3882DE5268EE4C47BE4EAA2E77692880D218A69578FB090ED8426C29217B72070BE2A4BF0D7BCB480FF262D2DC3BFA9C9D88FF6F5284D240E988E4F9B956AAA36E804BB38CE1F5AA65E73624940C28CF816F4C4F00751BCC6CDC79131E96294D95D6BC98F58A2A687EA7B0769A6DD4F4988B2381631EC1967EF4FCC9EFB7A7519783A33787850A8C752F36A4B3ABF7E460D5689009A232BEF1C33FB3D99069B0157764E4477E2AD68B3A99A05BD2D38288DDD416EE784BDC99E157DFDEC61ECB0C49763F187E947C54A4ECBF5EEB76AF5FEEB222B0844CC1BB9F69CF3B291671BBE98C89EF5D656DFC77375C39CBC2A7FF6413B3CA99834D1845499A09BC111C8582F567D187147C5BBADE2194871126DDA67DAF170079A618A77B8F06193E06F87D441687D1DE6E5CDA9C791728F837C945F2EB20327802B37FC6D9C2B125F4067",},			
			/* LongMsgKAT_0 */
			new TestVector () { n=9, mode=0,	// 256 byte
			input="724627916C50338643E6996F07877EAFD96BDF01DA7E991D4155B9BE1295EA7D21C9391F4C4A41C75F77E5D27389253393725F1427F57914B273AB862B9E31DABCE506E558720520D33352D119F699E784F9E548FF91BC35CA147042128709820D69A8287EA3257857615EB0321270E94B84F446942765CE882B191FAEE7E1C87E0F0BD4E0CD8A927703524B559B769CA4ECE1F6DBF313FDCF67C572EC4185C1A88E86EC11B6454B371980020F19633B6B95BD280E4FBCB0161E1A82470320CEC6ECFA25AC73D09F1536F286D3F9DACAFB2CD1D0CE72D64D197F5C7520B3CCB2FD74EB72664BA93853EF41EABF52F015DD591500D018DD162815CC993595B195",
            output="E8E0AFE48C65C3C179BED171EA5FE1D89D6A6C283027926A9B00B94454BD06433486905321B8F600148259377CEDA377B05197C98780DEA58B38AAA356B2152D487897DD02DC12F31E36B279AC872AE277593DB65505FDF68BC6D1EFC0C5E52CA94189632F5683E76A964357D85A0BF7F701A34E8EAFB3E8FC2CDD1AAA5D1C3C5B8EF165A61B52C3BC044D98A185B8309C13076A5FFA5F893854C0E25C4B66E0B0E34A4F1584BAF56326A2373647A546D13B2792B28604DEDE84F202680048380E23A154FB717C6913DD16D4291CBB3418E8FA9983F22A066C2ECDF7F9E42A8B89CED472BB771C19E340E09B68C677A7F6E96986E95A6FF95C50BA6AF86A6BB10690CDF917F14B6A022693B6FE145A22F3E0F299B8D9AA6F3F2CAD238C3FCA4E199BDF246A779EED47F02142B9DE260A17EBEC75CFFCCB001BB1EC19C546CEBABBA360822B22303A84F5CE6B2BE2495D92FF5E349B5C2B7650891A576C6E0C74D6673412A1D687E952FB7779BF05A1F2755F46DA2F47662482060053FD23C38CFFA2962369B957CEF14A0FD390D1E1E76ECED00A72757669FA6D3F07C9F45B96EA92C1E735ABABAE06AFD88253E07B98C0137F48249F5EDF19EF8BC5D555AF3853A4C3263CAB3E162E68E1945CED11386EF584600588A80C077642C453129E71C2F66C0A409767C9F14326BBA9A2850601D559DB13039A643D56192952B4BD94",},
            new TestVector () { n=10, mode=0,	// 508 byte
			input="4FBDC596508D24A2A0010E140980B809FB9C6D55EC75125891DD985D37665BD80F9BEB6A50207588ABF3CEEE8C77CD8A5AD48A9E0AA074ED388738362496D2FB2C87543BB3349EA64997CE3E7B424EA92D122F57DBB0855A803058437FE08AFB0C8B5E7179B9044BBF4D81A7163B3139E30888B536B0F957EFF99A7162F4CA5AA756A4A982DFADBF31EF255083C4B5C6C1B99A107D7D3AFFFDB89147C2CC4C9A2643F478E5E2D393AEA37B4C7CB4B5E97DADCF16B6B50AAE0F3B549ECE47746DB6CE6F67DD4406CD4E75595D5103D13F9DFA79372924D328F8DD1FCBEB5A8E2E8BF4C76DE08E3FC46AA021F989C49329C7ACAC5A688556D7BCBCB2A5D4BE69D3284E9C40EC4838EE8592120CE20A0B635ECADAA84FD5690509F54F77E35A417C584648BC9839B974E07BFAB0038E90295D0B13902530A830D1C2BDD53F1F9C9FAED43CA4EED0A8DD761BC7EDBDDA28A287C60CD42AF5F9C758E5C7250231C09A582563689AFC65E2B79A7A2B68200667752E9101746F03184E2399E4ED8835CB8E9AE90E296AF220AE234259FE0BD0BCC60F7A4A5FF3F70C5ED4DE9C8C519A10E962F673C82C5E9351786A8A3BFD570031857BD4C87F4FCA31ED4D50E14F2107DA02CB5058700B74EA241A8B41D78461658F1B2B90BFD84A4C2C9D6543861AB3C56451757DCFB9BA60333488DBDD02D601B41AAE317CA7474EB6E6DD",
            output="5A5541A0A3FD7213DB0646E8C046A14744E0FBED9C01840C3727CB196EBA962941EC61907604F8ADE946B7C5D2A791E7E592D6B870AD5838A9EF15C55864AFB3448C2A8077CAF72467473FE9DCA509430E8F6967BE25E4526D185DE8847A5B06128BB73C751653843529050FDCAE510BB01D72B0EE485EBA830A59F4E800F670EAE5F5F597629894D52E56CF25504CA9514253E923F7F4B2F6F9D5677E009618450EB2F059FA7F53563D8558F9752DFF5D68527C55A3DA39B440989BD0C6714380B78F97701755785FE2A8A69BB10F39462D10474541144F8B746457B835371679423FE5C90BFBCA519D79C7B1C27127989BDD92AE4A8E784304C00B968631C9C132747191A4A933538B312862678580E261EE31591F3A81204336C5C7A459D2E307D58863020FC649DB9296B369196E68B27562204FF9CF436BFC2F78692A3D99246768C591CBB1AF5580262A0081CB4D01F42CB245539298ADF67092051DA319C2B6124B6BEB4E5D60F9B8D05F6DF706B82AAC204697D5EED844081FE7BC028B7305BAF3723E66B18F21C84A73E9C74B7798595873FE3BB9884C47E2190DC84C782A37EF8D41DE8CAD33DE0E8858F584F6F458B59297F795F16F4E9538960672A4663F6ECBD20FBA5D6C9CAB6EBD64B4FF48307E921C9631EA93B10DD5FC3068F612B5AE892E22035E1E0CF10AC01E993BD80B2FAAB38DAF00869B8AEF0458",},
            new TestVector () { n=11, mode=0,	// 1012 byte
			input="670B79C6030DA4369146A7F14E6BD393DF729B60369D3D55461E5187D4F8E83114B227524EE955F64A2C607DA850235A1B49FEC6EB51EDC21941DCC67BD07412CFE058AF4505C325D94936EE36DE4133773ACF669515DAF4ED87508589CF651784A8C3820A88FBF7CB60E20A035ECD06405B50F6A13A36E174925B4E334E197E1E5FE86836ACBC1AC681CFD42B2F11F74587660DE867EBBA7222C3E89B42957AC4508F09B2DE9C3B57C883138F0D442A050D8AA3023EA920140F70237AB214BE9FA0C452C54B5020077ECC1F5DDF5D959A5AAEAACB381355FD7B493A1A51CE83E6EB52CC61214A02FAFB01593D5730C7058BF9106B8314F1005236E5BECEB3805BAC8FC4308B2007823BBDB3DC25042D6AB7745941B055A7648F99FFDACACA9801094EA86DBC9D2EF2B61A97AD5FB9FF754190A529CE65FE46AFDA3C0EAE0EC98ED5B089148BE358A8ABA6B2F014A5B74547FDC00501DDB1472EF4AD592EFA8031B0A4376DCCEA8714575BF055B1027824F463E8AF110CCB521B2F1363C0F13256B768645A0377541CF2F73DA03AF0C026E59570D6007BAFC297A41DEEEB32E79364F9EFFF6F81B69FDB99DBAE4DDBA46016F86BE1157693C63CBCFE24C7B6DBC2260798A6C397BD91D4ABE0D5C23B43769B0BA28B6B954E66035BDC52DE03B33CA004B670EA6E341B01ADBC40DE2F406BFC469122EE30192138868326BB642834F9E78F51976C3E6EA0EFA570926F47612CD0702EA82279D60E062832D31785933E3BEB86D187554A1675A61FB0B865092E518AD329F38A70E7DBD6025C9925FB0332B5ED97E77134B8684F6F167EA639FE6545FAE58B611922855B44E520601DD0758319E9491A1229DC49F9F6F9EEADD9CE88CE91E3BD3D13F64ED7745280F4828D3A00D66F3966E0EEDF930F563D8E48ED94BE42CE5F48E92E3F2D801FFC464692C10E7300AB0F85D1D44F353C742E20DE3706BBA4B24AC0048EA6E0B40454B06FA95E5DC2951CB4B0A7D1C15A3C12A3889C7191814161C5181880223FE3070404E61D9D382AAE8F236165FFF3121D1B4BBB5B4D9B01282E2663DE39C642839B34E853BADD9E2E2C82FE90FE755C8677DE6A405D1A23492D84AA272AD94C180300D737758E00DA835DA7BA9EFA3EA0C16DF2FD472C1B57E0D5CA40D43A3459A06A3360217ADF41645FEC31F104CA6166416E36597C35DCF0FA43298B7FCA4F5045AFF900298339FF5DBCC1408D703CEE178C6B194E1015DF362B038AFD349610819FAB289AC11CBB3F19FFC9FA0203C231711FBCC48922422059407EA225F8509761D3C53D83437B507814E61206558C8A27E7D55400C64C22AAE33C817324ABDD7114ABFC01CFB1AFC16296FF6B3DBC8218514B83102BC84272D41C05EAEADCF4A0FD9983FBB79627BA8F905E4CD345C874",
            output="A56498B310441482B18B5763C780CEC821B8DAF1FF58C2DDA311DB18423BC21651EF6AA5279EC4545EF358C2AC0E75CBE1CA994C0F46708CDA997990FA896D3082F1DC7D3A58D30707A0410EDF8E354361125769DC8F87E81290EC43D798FE8F494C65DB1F8BBE152ABBDED9E681374CFCDB374A07F9D4321D3CD37F735473188790B1B0D243274CD00A2AC0C8F3D494DCFCAC427F8A63041C3C348012328C277E411182C673B8B5940B79ACAD2937B10D9C45E066402A046426E57BF130310E5C57EFCD63873D3762D3A1FBE03773882AC4ECD49DE01D8684B03CE9936FEE5C30512D4860B4E57F796A1F5D44054DD1E46A089F85725B1B0C346AAE4CE477D1766171B34BC25BCD0CA48D8ABC2CB7FF4632AC51DFC60B20F4C28535DD169AE2DD70EA4101423823B8C3898286F50D609E8F05539F8684FF9523736A5D3AF50A5FBB33573CE6ED3580801CB09388924E6568CBB863ABA181E75D5187AF2E583DC026C6088CDFCC967FBC34933FD3CE1C0FEF36FA0820F99F4771CF132601DB93F7C17119C9703CA5B529329984411FD49ED7F1A33ACF6F6120F763919124593ECAA589E9A70562BCF964BD21DD19ED3638792F0CD8E5C5EE394D314977ED27AC579466A41C8436ABCB3CC8EFF6A7C6EF7CF2EA204D42EA001B2D5F305FC347149D7C972615D57BF58D615025E0CBF0A0D950D757495A3310BC1778C65782A45E",},
            new TestVector () { n=12, mode=0,	// 2020 byte
			input="FBB36A6D35FA8C0174BF87FD3C232D1F6059B8C43CBD7106AEA406CA2EFDCABECF3B05DB8AE53CF98E866DFC5EE714EA3C555802F7515598560BB35E0F0B26D5F51B81FDCE914E3651C21951CC45DB3B480821E41654368B3259E953501621FA549114D80A534FEE583AD61D681C4FE402925D3BC72A7A63D042CF051EA2FBD2B110017D31218FA0BDA84286465740D549F7035492B2C0A282544CC536B8E4EB8695437D6038B13F9125F8C4799CEAF85339530E478AE2ECD4FF909BAB849A18CDD775B6758808141B94F1A243BCA4981C9D4B7A29CE53A2C17C3E62E657BF51B6163402D6C33F17FCEA979E40B0D6ADAF572A79030AAC63E02E99310B133BC007AAC9FC8564200A9BBBA0F5B1228B7D9E869DD824319568CEEED7A9C87E5A5C20A6F65879150D8D279F1376960E80A6E1CC929B30406765BAE97B22D08E0225BC320EB5004DB4F4648E6B8F8F1FF13182D1B20838CAF69B054E72DF07E3E5C53C669281E227A13FF0F6350578F2E257D9A2DBBE673F8D4666F3FE6B46E007A08D4C79FCCD4C8244DEF3DA4B8619B2389FC79D5C15432B672121FF14B58742DCD565EC5EAC780BB8832DA16C3307B8E63D41500E618C8FA9EE077F4A98236809CAA3F3DFFCEA6EEC7DC376226C80C5B1DF3EC161C9993DEF3903D542EBEC844C2E7E69FC215BC59FE86D5E98F98E3B8237D54CB2C28B414700E1E977B145C768301E78B9310119BEADF695A05C509D95863C4236A3B99C1997EC739EF4F3D74DAD5FDC66E494EAC463844874D6A9ADBA891C617A9F98D830FB0E24CC09B70114B32CF242B7C110715F2958219596E0AACCAB5DCA7AEB2C1649358DD95817EB35CEF4DF997242ECF387D6A06149E6B4661203627516812D7472B4D3F05F1AA200D5990201E97DA0F3D3ACC81377752C7B9455B591AB6B46AFE8DBDE732A9664A42175C20989B5A307209F64B0F2AA00BD297F8EB72ECA7255B99F07298B1C59E3D413327EF994EBCCAED1D986500AD2DE5915908DBEAFA00498FA374EED2537E0455EC5060F8CBCA77029CF2F21B0D2EF29950222947D3B926BCDAF61615F73F0195EBF189CBFBD25075E6C70640A81E64C36B54232CD76EF24AECD8E619F652AFFAA27A39FEC7EF7DF3B6C9D03B51C0975ECC0CE4C09CA29F56380F0B2B293321ECA37A6675F43CC7D7A4A196D3D11ACA35A54ECA60DB965EE1DB7095D481F1F276F6AB4C0B37398C76ED4A5CF2BB7B9C401E2686FF8678AC6C1D141C3A40D41C44B3F2933DD4B258EDB45DB5675984E6880C3927DD5087F94E122283FB76C0F622B671477B2C535193D1F4330EC09CDA03A1E4CCD1A06447E078AB7A37E34E54C2E0D911593FF522ED94B5FFC14E62FD21D00D7E5BCBEC5190D5A40615FF64740A1D31D0CDD07E39BBB4F615A4A0345AF40D0647F354F96FF2AF3EFBE25B9E38E1C5550968A18BE6DA252A5BC861CFE2D9CE84F56B0071CBAD937C947C58D0301E51DD1C3146F7810D795204BC0C7FB71F96224BE409FF732E14DB1C2CDABA7CC746C4FEED829A7077F48C7F466D1EC0C89E3E247D15A4A63114EA1E6FD855C98CD7870CEFC75ECC8114F1135A1540DE6A8E1C05C9D6DC554A6B08E86C8158EB3D844C5348A61D54A6559B0B7F4BC592558200A289CCCF39AA308782370B2981CB5EE050710E012D4F58A9D1E2E0B9DD5A3532455FBCC1DBABDF041F0E7B9DBAC805A503832DF59B29D0D1DD6E75E735DF9082B458DD10920C2CB72CA4AE28B63815785656A7BD897F1436393780DAC6004F68A745B235913C536DBD5C23EACC6BAE635C949EFDD2941D9F1A93ED944180427FF57D0AE76A5D584430FA031D8969883E09E853E6A29921D70214BBE2F7477CCC9F16D18EF6911091D2E62A8C00567B831FC79CE5DD65A95304FB7B0C56CD4D7FEF15DE5FBD19E312EF76C58C67645003BF0A55610F7A60C7D7C5418EE04C45FFBDF3D9C3C792A5E92979D6F8D1998C00A020C0F1974BB867335288F006DD0E973A376F353AC0D97646924C1B35C274E6AD1103A1BDECEE53D2CDE4686BD6AAB9407A568C7E029B86557617C261590384259B3093E0098F11C17DE7210113D586B4624C2E052AE6738EF10CCCC728F2AE111458E5FA1A93EA3A594E03AA1C65E5471F24F3B8AA126C385062A2FBC2AE2F2951874BBB64E02F3009A575941D4235B06C1FE451A825CE91BE59BAB85DA91645E0E2B8CE374DFB054A40809F26DB0AEC534AB5CC27E27477F1C1A729F2CC0C11FC51417B71443B657FD79DA807BB01CD01B036C6737258E60DA376DF08089F41056FC454044E0F1D173A7E6F11355851D36626A4C3E89721FE659BF58B72E411B015BF13396B269142C576A5976AB352E1708C1908C43D873964A097721A60485002F4675C5A5F582ED4BC7786EEB2D49232DADD6649BD9CEC32D6901EA5CDA7BA838817DB8C0AFC254B94E4AA39C0671EC45CAC70A73BDC77E821CD8BAA77DF6ED0F3F79386DE1FD7D7D81AE7E05DB6D1D9CCE8F42ED4FFB1A7FBEC62984DEA74C9480945EB916752EC9E0606815F8D5779CEEFD2DF49775A1CA29465AC9783944A0617279303AB86C2AEEB1AB4EF1FFF7465EA6850109D770C990B842A0A5DBB1CC14EA4947A356678FDA4EC44FC9D8FA352A546A2485F842A6BFAC20DEB0458762A72DD4A039D64AD8485D9F1C4D67EBB87B99FA95CD5B38DF8E32CB6EFF1401D0D2CD20A7DBBC3977B0854EB9F945510125464300C91577B21B6A0A61341379D1F1E15937C4EAC435D05BE9282F632F84C2AE1290C6DE6CA6C5ABAE90A6C9F37321966CD33D86C6275C018FD2C15AEC46C095AC0CD51593CFB646E8A5F8",
            output="67AACADEB0BA86C4AB8A677DF45091786847ACAC5F30693DAAA94280A663A72074A979B8571D5031E50317E7716E331B1FFB372226946A609D2AC816A7FC94C0FDEC5CC76C4AAB536D97AE2082D24C08701B5D1B985E73FF39904858EF80575E4C09E7694B201C4E7FDBAD21B9A53ED5326963EE7D7183A5D5049FCBB7DC959BBF76B88293BAF447F0EB402247D0229408559EA7BEECAA8D84A15AAC5F6F8C1274C23E87F458A2D4F83E6083BAC766EEDAC220CEFC03A3AFF8D3083C899D6051AA472DBD712117BD10D77C0E66C611DBE33BB055FEA5C7B842F5A432369BC3365575774871B43A5A8FBE430478B2362DF57566A2E8893B5A2CFE584693A0FFD4D27B30878F7B508E00A588B710756594A6996F0AE746594781A055FE98842F66D40A85552BF1D34480141EA5EA8B847B6A3C49955259D3D512785C08A027379D16C80F4A0F9D19D7B788AC38BC80DC5EAD7396917140EE6EE75001AD730F391EADD324DC36C7D343AE3EC4B9E2DCE730EC049C42D1B918E769469B19996C589801E87894FCA114A9385F19C79F252CF882BCD5B5CF236AD73DC180DEF10A6C0890DFA95077BBC262B3BD1707D28C863F99CAB47C580329D9F9AFD0AF8F439AD540AD70A2CE619F7D40693A5AF8DD21388E3EB894610C2B949641482B5DEFB1CBAB7F45275BD5E4B8B9A5AD5614FAF0A00BBBF76644F3BC0C1D7A5F3B10F4DCD4",},
            new TestVector () { n=13, mode=0,	// 4036 byte
			input="09A96A0112B823C2212ABA52EEA13C48CAE3F5E08883453E2085A803EA852A9D6AE075392BBD8FCEC567A1524AA65C70C3EE1722AA079AFD41696CC5391F529299C71E99B0E08E411D3E1E05C43E979CE10AC9C2EA80CBF4B58371273C3D3A8DF48E2DE7F50560FFED25F6E65E9D96CBB379573BDBDD2859D13F866EBF3AF488C6D2E36505A70D81AFD07E321157795CDF40C1885DBAEBF3D4E425EB4CE0CFD6CA5019C8DFD54BC2A30095B312AF4548B9ACEBB6A207AD3BCA29F4DA443AFC7FA789AADBD65C9D45AF71594B790FDF84D9235933EE96FFD83D1A1DAC8C1F3C2BAFE668B8EA5C9649D1D8DAF2806F0519448A97AF1104DBA3FB05CC46D33FA0112DD0922CF1AC84D4A343F1AE597930042AFF6DAA75011BE4B18ACB257D889A80F0C3D4094EF7295ED4E8C2F1E2B8F56EDBC9B831333677A4E6CF6110218B23523EEEE1E024B6398D1CC572DF7AA103CF7F50FA488E19936D20393A55843C042B275B78CAA9EEFC77C44437C375D4D1100BC486FCB0D250526086EBD4D2D38FBC8E3E55F9262B4BE5E6CE6AA3164DC04D7FB12BE70AF6861AE0C21A04468339D335BE15F6A77A8BB84CA4BBE94B0782241500B595FD671B30DC6C26317DB3AF8DB1214B144FC42FE936771469D3838E41C16EACA8B44A5915D1CB4550A451BE5F0673FFE846F6A22BBD194C8870193E1B68459B0593930E178B765D5C19B0F9D65B1E25D60B727E50EE4C39D1B898CEA9C8E95E40110E40DDF882A7C89303BF1B6AF90506E4709A7916F207BEECB850C9E227C9557536138594513043FEBE778C471DFF08ED2ED7F8A54952F6F52422AEE3240EEF81D34CBBE47C0CC59A239D7AD75852CF62473FDFA9C723FEC82C384D06F2320C8C3E5A1483D9B573AEE03FE0F85087087B896A569D9A07B02A387EE09ED6B7C8D6C0ECA76EA61301791C9F835E5CADD14862393A698DB23577A68EFFDB68076FD8A0E7BBE9D93098E73F5A174CE406441DF48B969B4D2502EBBBD9937856777D6F13852D9AD3A39702BD556009082DC207C442D327EB33A24F18DC56428B181C7B4405D0B2720B8C4C62417AB9F9DA5566BD85FB7FC567F542D05111842DE09114D27A382F009BF737EA2D8D8E4F0900A0DEBA080CE6B0FD7F0ECB3F81791717EB121176412E7CA618735BB065A659B689A18069B2C43B00EBDE9DE272106E180EEA446242F7889E50920EE5DA2B7026965B6DFCF4239ED8EC7F7363903F10EF6CD80D76CB42298E913C829B66CE1A5B18047EF06FAD79DE360908065E3A0F61AAE3347A1D7601188DCFD62C56D67573EE4550D6269FF7181CADCF84059749C8A4AC1A46746FFCAB7CBFA1840E5990483795452EF93075C92A4D115ECA32EBE5EF0211764AC8F6D61EA5A75530508A8724CD118462CA6CE37E85E337E312C60E43342497A9C50C05B38A6D5C253E1C001538B43D1312A369D8301544CC24B3BF3089C5D119AFE9979430223191ADDE6B68135B5D8AD5CE4A808580BB1C34F650EB63EEF3D592BBC45BB7F2DE9ACF2D4BC2820EC1AA765F35FCB3F71D862AAA1156D0838EF06241914AA4B8632733B823ACA5801BD281D127238676380DD88E9BE0D6DDD0AC7E87CDC175A24343B752A46AFEECAC7561766BC33DE4363DDF07F43E9BC4A1EC5F0FE36F40C3001F1647058131629E2CCAF056B381FC3B576D8DD072B8B2AB0D251B9060A9F76B3D99F2D0EBF65781B9511DE31027D8286299DE9FBC9C1C28BE2E4DF9CE8240852FE042D572236AC54B42B690D25ADF27C26A96D0FD048F1D11299636B55631D378826370AF97D76E402CF49CA5687C17E2F8BBEA0ED83535535566D65F0C6F7B2D887DCD391DF0E9CEB27BC0A8A33039CDCA515C886D890D69A389AF7BCB9C9E58DE0636441397A53AF09A447BFFD49BEF7287AAD01A1827FCB8641F9BCB7642952D7E19448C4E88DC5ABB28E24BFEAC16BBCB9F8E9962F532B428CCF86EF635697E179EA3283879E9375FFDD4DD9986CF862170D3D8574340420B43512D5A368CF338B732EF447A669C511466DF0DDD9E5E26A19A2ADFB17CFC593570F6C6775D70319E4DCDC4BEAF70AC768E7837FEF94C785EB54B1A6C164E09FE88791B3DB6D1BCFA4EC170A3695FBC21C9AD1942D3A483CBD433D3FCC899F12BB9CF788666C0658CFDEA7F29D5CAFBF3B16B3ED95E52AE21E599E6354D65305D073DE34B677CFD9F0FF0CCEF956BF561043E0DB96762C3B9365247C151CD0607551BF8D781E0CE84D23EF7B6A3B67B698CF3EDC2DB9D968174C0A26010FA7FCCC5F87E8B25D12463392BBC404B22E046B53D183A6861F6677108484FE59E41077BCF6C3759663112BA951014F40952D29A159BA3F838A8CED3707E45E0837DC62D0576A6DD12F3C75CF902636DF5FBBDCD9B19037E69091B26082B7DE2EDC1EC5BC218EA760C4B534AAF352252043DC5B4ADA60A9DEE3218F18DE60BC654A90D82430567F0C591C7219042180FC8440B5E422A4BCAAF92553BA86B149C7D5E761390C52EE0139000595E1712938030F387BC886C7E66BB11F74A6CCB5CA93099DE06A0665A1A99E146E480FD80D7ED360E95FB3B2B08BC2354DFD56BFD4031538F438AC102B73472DFF3DDC93BBEC4F9987DCA8DF79115892A004E86F4FE8E76BEC145A19C013630DE218B3AE3C325DD622DBF17897D68833B43E8708349680AD1836044F09D0A36A00ABBFB9EB9B9FBC39EB71DEFED6B2B86F4B85091A2A1C6141A2D74A8B2F11E7CF4B5BD0A7605F43B752F1FE2B5529BC0B913B5981149F8E3E23808193741F152D77A1018498B0459820A8E6EB661B63325D41EA2E80D071417816551272EDB519DF379E5CB0730ED933597E0D62858275390331BB048D21F753FA50262FE9ED6FF00F54FC0752DB016A3F5F8DC4114DFB760E8E9E17A3B876CB7FBC3F443843A9DF4626740BD0C511BFFFE4F7849C77EA64857C489C204DA3FBF6C08ACDD705D7524245BD23E3767C6587B0A70743AABDA3434F0969D007BBFDD27968C4E7FBBAB2621EC26FC28FA984A0E7513C548F5BE67BAE139098873932BD651FA85F8978F8A52CA1111C354AAF07728A1A4D8E8BC45CDFB174FD8CFFDB8B23CEE7CB7C7CF2CA590B93C4EEB403123B2E10293021A737B2146B21327C0F2FFB59176D1B26DD3A1B7DFE3467613207426B3253FB61B0E42969E5F6F01A102699083010D5F53F10C36F0C69EF73B350B144FD295063B19770552CB2B06F215CD5F308658DD34C12E66EBF3A48DF9C81EA40A728A035E4D20AE4172A6556D3CD5DA109E0D2C5C40F58F104BE11509282B67826831A9560584466A93860731C3F88A293685F658C15D4E3A12B38EF63A4A175F74541F0AAC499E3916A5C7FA3A2B3085CFEDA45939C319B39F887705B9F089C90FA38D6269F04756152D6B58FC22AE8A16D1F093548019E9EAFD24323AEDC65FB80FB9A9950F96B9AA56886A9695BBAFA19A9DF70A97EB73729915AF4433D38A2ECEA40ECE0DA71C0EAEBB61D5C906815135882932B2442901DD719BFB3386DCB45746FC7603E1B57C3032D54AF98A528F3D2F8D801026CAF94FFC0A95258F28AF7BFA05A6CDC6DBC84DAD9F7FA520A708EE18E6ACB316235479C49CE5B8F0D896EEE70293F822FE85E9D15B5F4511CB2E5C4926D9EFC11FF931B465609532D3F78ACCB08B3C2597AAD082852238F24DE905D433484D041C9C90E1F9BDD14524EF593ADAC25B0EAA59F5D0223DE157DD2AEF4364227FCEFC25DC1E98785C40B8F491DBE834713C9C9E8CCB72133351C8AAC3625A3337D637C264D9AB02DE30D78A7AA54891EA52C96E7F061AFA558F5F661D8752F54DBEE025A68B72E205ECB2D14EE84C7DFFCAAD8F2829F21B778D85BA3C590394AD4DE39587D40EAB0915A3C7E7BC89BFCC7566D1F44D250FC3DCA327E7DFD2DC7E04C01C5773B7DEEE558106A3A4D7BDA8347C8F5C11500551345E963A34FADE1AADA6F88B7F73C3206173C5B5A831CB308AA338DEC57F0BB4D0D43B09880E2E150D438DBA83AB9F49B4C3B812386DD2E11FE992B32DDEB5F0B3F2F100D989A6482BF705E190E8201B614AFB5BA6736D0EC81DBB35778E65653F38F49694B85B0E78202C3F805FEDBF6EC5795F93966DB9656066944BC2E52C10A5DCFF5BA68F008C40E6C801D16EDD033512B2F2F5E51F3B49C415EEADAE4F878FA44B3AA6965BA6B7A118297FE5993C9A3EFC22DD57369CE8FF709D835C977874ADFEF7D8D252D1E8F6F5AD548D8D14D89C72F2294F954C6CE353D0C3F43A76BC5E3BA7C0707BF21E4A4D6EBC4B99D34506B4AB78E622BC32AAA7307DED2F55E575EAA6A601E627F09DFE02E1CF3D59D027E7AE1DBF4C1365231B724B03451E79A3512393C843EBE474D29E3EE1828B1010A746FBA2E6483A5F29336A6CF0C95E9D3B929D1FAC334D2F391BEEDE2F0DADF399805B4C039E66FC2076734DF2062A09AADC69DF10AFDEF8ED1A15B5D81041C3B0A04E1A12958627B58056FE33397BCF5EBFFF54D34FCBAD32906A5685EE8A4DD34DBEDF4DBA832F24640F090CCC21701A4B35ED37DAC3E6961EC89EA0815751D55871A13125D734EF178124AE1F593D89609D121878B3151BA96C8347B166558FBD27D4D201D76CDF4774244CEA527896874EBDAF9AF7293AFB14A4E3719D50D9C9902B92741BCFE0572D37EA11DA57298DC9F710F3D2294E48F68C47D972CD0261508482EFF8B290F52737E641B61E9926EEC020FDD74A1A0722BA534954D4CEDB3ED44EB255069708BCE9A22564F5B4990562278E2E89245C54B8278EC17C8B564157E87DD52CDC1A67D60DFDB6CC9ACE96A5BCC77CD33A10C506660548A167193A6A13FA6FBF310D803BD732A51BF85C72AAF8688979591C5D829EF4A7EEEC82017CAD0880209C4A64A0EA4BA22F40D26CD559ECEB9C879AE413D60240E26F88A7DF0557DB1E0BF938327DC4CC0664E0B40E9D0C67A431C1580635BDE040FF2079FBD5240D2DE2DB112AE4F3411D0F5908DBDAED1515163B621A66CF0F3D80AFA0E0B563F3AB81FD06117A7F21E7AE2FAA461EFCE961FEFDABCDCAE27C20F0114308BAAE0228D8490A0A840E39BC9A501C0C591CA28FBA025E145E4FFF4B432A161BD821FD862855A955035C1ADEADE98CDEDD8EC0BF0881CE6F3FB3B69501B164FAE089FF007A923F42546019844C06387B847071716B30491A50A836DF913DC2BA22D0DB14D18F848126AC124E5E9A004B5473C606AE5402357A93FBC7146324E269B6248B43CFC2291031F7202153CBC4563FBB0E6D008D6B0DAD9A02D03F33FBF8BC9207199BBC19ECA800EFAEBB5B7E1F8929846AA2CFCA4B13EE3652477FE3EEED93B63CF2508A1E540BD35250FA40F93A41AD70A4E5B547006968106531419E8DC60E423129FD627BCDF14BF0D294984BE3037D4F5CE6EB8AAC28744AA31325BB32CF85D95F04573040FAF554D87BA7E1BFD9CB37D43E2DF6A8EE09B8423F8FAA8F0744B0F383FE9AB403D5B77F8B2DA1E26E3BF20E5C195EF3415FF2DA74003B9F82D74F5A4AF4EC1F9E87E2ECF50B362990FFF432FC7A986578B0D0166175F087DC8D724FE43EA6D7A541AA7E5445B0273B41BA7818A96C28265DB7FC729FF72C8DD635269F0C35D43D8CD2A0D4ACEDF13C75130F17D65C57A9ED2D26D5A6ABE06E40CC7B78D2A554C0A2",
            output="9CED59A5E97B7377EABE9558B99E629D3B8B9A38D26BCE2F2703254E7D9019FAC7A016DBC936BDD2980AA1AF0E0C24ABCCD13FDFE49FAF542124C7FC6FC6CF08F72167CF605CFB7509C69EFAFCD3E177F0741E7C73ECB4131DB10F822EE8F44FD9BCDDE8D5DE9F0734A52F45408BA76E54477186DD61578DF86B8B3A171B86C453E938925EDA9C5C5531586FCBD69355396EF2B74E0387363BC2D57EDEB41EADBA64A880091CB32C85D97ADB1DF1AC9910A5EC3402118E776C5FA1F2AA4B72F87D7F28C53029392F50FEE55E38ABD8A331E2699E154E3F6FCAD821C5BF7B86BD45E966570ECBD04D64EDBF01958E9D0E1FB7C27B48CFE1251A58D5F5E4AB89CC91A8B54C0F32BB3C8011A21C6192AF9CBDEB1A97841CFF144D2FDEF24004A439708BE4A58C34F11E4DDCB2134EF2BC8391C85A1AF1C7B3EF245192DE6C4F35EF3D887DE1DFE87FF1B9A0BB8406E416B0B65047DF1425DCCA82A928416C0F259661BDA8B8577298F8318DCD5A2467F40AB698BAACBC75E3C20F388E9623B7002F541CA47E255593370A4D9223BEB9215A49892CA58283C2F4DF33C6F6D41D3578CC3900D46372A5E71B00A22E6530D9ABFD375A2C69819D614CB62B3AAD2DE26DA5A3ABE0F14B7DCBA6E0D5B161DA74315BEFBA1FE7384FAB134DC7E7559C6E10F3DED9F4D96111ED7EC5513545E73AD55BCD2AFF562210BC46DFA3255E16974E",},

        };

        //SHA3_224 test vectors
        //from https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing#sha3vsha3vss
        //direct link: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/sha3/sha-3bytetestvectors.zip
        //We use 10 of the short test vectors to keep the KeccakTest.cs file small
        private readonly TestVector[] SHA3_224TestVectors = new TestVector[]
        {
            new TestVector(){n=14, mode=1, input="", output="6b4e03423667dbb73b6e15454f0eb1abd4597f9a1b078e3f5b5a6bc7"},
            new TestVector(){n=15, mode=1, input="01", output="488286d9d32716e5881ea1ee51f36d3660d70f0db03b3f612ce9eda4"},
            new TestVector(){n=16, mode=1, input="69cb", output="94bd25c4cf6ca889126df37ddd9c36e6a9b28a4fe15cc3da6debcdd7"},
            new TestVector(){n=17, mode=1, input="bf5831", output="1bb36bebde5f3cb6d8e4672acf6eec8728f31a54dacc2560da2a00cc"},
            new TestVector(){n=18, mode=1, input="d148ce6d", output="0b521dac1efe292e20dfb585c8bff481899df72d59983315958391ba"},
            new TestVector(){n=19, mode=1, input="91c71068f8", output="989f017709f50bd0230623c417f3daf194507f7b90a11127ba1638fa"},
            new TestVector(){n=20, mode=1, input="e7183e4d89c9", output="650618f3b945c07de85b8478d69609647d5e2a432c6b15fbb3db91e4"},
            new TestVector(){n=21, mode=1, input="d85e470a7c6988", output="8a134c33c7abd673cd3d0c33956700760de980c5aee74c96e6ba08b2"},
            new TestVector(){n=22, mode=1, input="e4ea2c16366b80d6", output="7dd1a8e3ffe8c99cc547a69af14bd63b15ac26bd3d36b8a99513e89e"},
            new TestVector(){n=23, mode=1, input="b29373f6f8839bd498", output="e02a13fa4770f824bcd69799284878f19bfdc833ac6d865f28b757d0"}
        };

        //SHA3_256 test vectors
        //from https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing#sha3vsha3vss
        //direct link: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/sha3/sha-3bytetestvectors.zip
        //We use 10 of the short test vectors to keep the KeccakTest.cs file small
        private readonly TestVector[] SHA3_256TestVectors = new TestVector[]
        {
            new TestVector(){n=24, mode=2, input="", output="a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a"},
            new TestVector(){n=25, mode=2, input="e9", output="f0d04dd1e6cfc29a4460d521796852f25d9ef8d28b44ee91ff5b759d72c1e6d6"},
            new TestVector(){n=26, mode=2, input="d477", output="94279e8f5ccdf6e17f292b59698ab4e614dfe696a46c46da78305fc6a3146ab7"},
            new TestVector(){n=27, mode=2, input="b053fa", output="9d0ff086cd0ec06a682c51c094dc73abdc492004292344bd41b82a60498ccfdb"},
            new TestVector(){n=28, mode=2, input="e7372105", output="3a42b68ab079f28c4ca3c752296f279006c4fe78b1eb79d989777f051e4046ae"},
            new TestVector(){n=29, mode=2, input="0296f2c40a", output="53a018937221081d09ed0497377e32a1fa724025dfdc1871fa503d545df4b40d"},
            new TestVector(){n=30, mode=2, input="e6fd42037f80", output="2294f8d3834f24aa9037c431f8c233a66a57b23fa3de10530bbb6911f6e1850f"},
            new TestVector(){n=31, mode=2, input="37b442385e0538", output="cfa55031e716bbd7a83f2157513099e229a88891bb899d9ccd317191819998f8"},
            new TestVector(){n=32, mode=2, input="8bca931c8a132d2f", output="dbb8be5dec1d715bd117b24566dc3f24f2cc0c799795d0638d9537481ef1e03e"},
            new TestVector(){n=33, mode=2, input="fb8dfa3a132f9813ac", output="fd09b3501888445ffc8c3bb95d106440ceee469415fce1474743273094306e2e"}
        };

        //SHA3_384 test vectors
        //from https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing#sha3vsha3vss
        //direct link: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/sha3/sha-3bytetestvectors.zip
        //We use 10 of the short test vectors to keep the KeccakTest.cs file small
        private readonly TestVector[] SHA3_384TestVectors = new TestVector[]
        {
            new TestVector(){n=34, mode=3, input="", output="0c63a75b845e4f7d01107d852e4c2485c51a50aaaa94fc61995e71bbee983a2ac3713831264adb47fb6bd1e058d5f004"},
            new TestVector(){n=35, mode=3, input="80", output="7541384852e10ff10d5fb6a7213a4a6c15ccc86d8bc1068ac04f69277142944f4ee50d91fdc56553db06b2f5039c8ab7"},
            new TestVector(){n=36, mode=3, input="fb52", output="d73a9d0e7f1802352ea54f3e062d3910577bf87edda48101de92a3de957e698b836085f5f10cab1de19fd0c906e48385"},
            new TestVector(){n=37, mode=3, input="6ab7d6", output="ea12d6d32d69ad2154a57e0e1be481a45add739ee7dd6e2a27e544b6c8b5ad122654bbf95134d567987156295d5e57db"},
            new TestVector(){n=38, mode=3, input="11587dcb", output="cb6e6ce4a266d438ddd52867f2e183021be50223c7d57f8fdcaa18093a9d0126607df026c025bff40bc314af43fd8a08"},
            new TestVector(){n=39, mode=3, input="4d7fc6cae6", output="e570d463a010c71b78acd7f9790c78ce946e00cc54dae82bfc3833a10f0d8d35b03cbb4aa2f9ba4b27498807a397cd47"},
            new TestVector(){n=40, mode=3, input="5a6659e9f0e7", output="21b1f3f63b907f968821185a7fe30b16d47e1d6ee5b9c80be68947854de7a8ef4a03a6b2e4ec96abdd4fa29ab9796f28"},
            new TestVector(){n=41, mode=3, input="17510eca2fe11b", output="35fba6958b6c68eae8f2b5f5bdf5ebcc565252bc70f983548c2dfd5406f111a0a95b1bb9a639988c8d65da912d2c3ea2"},
            new TestVector(){n=42, mode=3, input="c44a2c58c84c393a", output="60ad40f964d0edcf19281e415f7389968275ff613199a069c916a0ff7ef65503b740683162a622b913d43a46559e913c"},
            new TestVector(){n=43, mode=3, input="a36e5a59043b6333d7", output="bd045661663436d07720ff3c8b6f922066dfe244456a56ca46dfb3f7e271116d932107c7b04cc7c60173e08d0c2e107c"}
        };

        //SHA3_512 test vectors
        //from https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing#sha3vsha3vss
        //direct link: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/sha3/sha-3bytetestvectors.zip
        //We use 10 of the short test vectors to keep the KeccakTest.cs file small
        private readonly TestVector[] SHA3_512TestVectors = new TestVector[]
        {
            new TestVector(){n=44, mode=4, input="", output="a69f73cca23a9ac5c8b567dc185a756e97c982164fe25859e0d1dcc1475c80a615b2123af1f5f94c11e3e9402c3ac558f500199d95b6d3e301758586281dcd26"},
            new TestVector(){n=45, mode=4, input="e5", output="150240baf95fb36f8ccb87a19a41767e7aed95125075a2b2dbba6e565e1ce8575f2b042b62e29a04e9440314a821c6224182964d8b557b16a492b3806f4c39c1"},
            new TestVector(){n=46, mode=4, input="ef26", output="809b4124d2b174731db14585c253194c8619a68294c8c48947879316fef249b1575da81ab72aad8fae08d24ece75ca1be46d0634143705d79d2f5177856a0437"},
            new TestVector(){n=47, mode=4, input="37d518", output="4aa96b1547e6402c0eee781acaa660797efe26ec00b4f2e0aec4a6d10688dd64cbd7f12b3b6c7f802e2096c041208b9289aec380d1a748fdfcd4128553d781e3"},
            new TestVector(){n=48, mode=4, input="fc7b8cda", output="58a5422d6b15eb1f223ebe4f4a5281bc6824d1599d979f4c6fe45695ca89014260b859a2d46ebf75f51ff204927932c79270dd7aef975657bb48fe09d8ea008e"},
            new TestVector(){n=49, mode=4, input="4775c86b1c", output="ce96da8bcd6bc9d81419f0dd3308e3ef541bc7b030eee1339cf8b3c4e8420cd303180f8da77037c8c1ae375cab81ee475710923b9519adbddedb36db0c199f70"},
            new TestVector(){n=50, mode=4, input="71a986d2f662", output="def6aac2b08c98d56a0501a8cb93f5b47d6322daf99e03255457c303326395f765576930f8571d89c01e727cc79c2d4497f85c45691b554e20da810c2bc865ef"},
            new TestVector(){n=51, mode=4, input="ec83d707a1414a", output="84fd3775bac5b87e550d03ec6fe4905cc60e851a4c33a61858d4e7d8a34d471f05008b9a1d63044445df5a9fce958cb012a6ac778ecf45104b0fcb979aa4692d"},
            new TestVector(){n=52, mode=4, input="af53fa3ff8a3cfb2", output="03c2ac02de1765497a0a6af466fb64758e3283ed83d02c0edb3904fd3cf296442e790018d4bf4ce55bc869cebb4aa1a799afc9d987e776fef5dfe6628e24de97"},
            new TestVector(){n=53, mode=4, input="3d6093966950abd846", output="53e30da8b74ae76abf1f65761653ebfbe87882e9ea0ea564addd7cfd5a6524578ad6be014d7799799ef5e15c679582b791159add823b95c91e26de62dcb74cfa"}
        };

        //SHAKE128 test vectors
        //from https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing#sha3vsha3vss
        //direct link: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/sha3/shakebytetestvectors.zip
        //We use 10 of the short test vectors to keep the KeccakTest.cs file small
        private readonly TestVector[] SHAKE128TestVectors = new TestVector[]
        {
            new TestVector(){n=54, mode=5, input="", output="7f9c2ba4e88f827d616045507605853e"},
            new TestVector(){n=55, mode=5, input="0e", output="fa996dafaa208d72287c23bc4ed4bfd5"},
            new TestVector(){n=56, mode=5, input="d9e8", output="c7211512340734235bb8d3c4651495aa"},
            new TestVector(){n=57, mode=5, input="1b3b6e", output="d7335497e4cd3666885edbb0824d7a75"},
            new TestVector(){n=58, mode=5, input="983f235a", output="a5597fff9277088ab56d4d5485023fec"},
            new TestVector(){n=59, mode=5, input="76fc16763f", output="a539f540f3e69e2d25a46ef0b1cf16dd"},
            new TestVector(){n=60, mode=5, input="cb1b0103501c", output="a07d5bd636c2ecca4b239124ef9fcac0"},
            new TestVector(){n=61, mode=5, input="7216a825029da1", output="9de6ffacf3e59693a3de81b02f7db77a"},
            new TestVector(){n=62, mode=5, input="7bf2fef375bcaff3", output="5ef5578b89c50532131b7843de7329a3"},
            new TestVector(){n=63, mode=5, input="fc948f094aa4b4e035", output="9dfe4efaa2c43081702cbfe8636859ce"}
        };

        //SHAKE256 test vectors
        //from https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing#sha3vsha3vss
        //direct link: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/sha3/shakebytetestvectors.zip
        //We use 10 of the short test vectors to keep the KeccakTest.cs file small
        private readonly TestVector[] SHAKE256TestVectors = new TestVector[]
        {
            new TestVector(){n=64, mode=6, input="", output="46b9dd2b0ba88d13233b3feb743eeb243fcd52ea62b81b82b50c27646ed5762f"},
            new TestVector(){n=65, mode=6, input="0f", output="aabb07488ff9edd05d6a603b7791b60a16d45093608f1badc0c9cc9a9154f215"},
            new TestVector(){n=66, mode=6, input="0dc1", output="8e2df9d379bb034aee064e965f960ebb418a9bb535025fb96427f678cf207877"},
            new TestVector(){n=67, mode=6, input="21eda6", output="f7d02b4512be5ddcc25d148c71664dfd34e16abea26d6e7287f45e08ed6fcd87"},
            new TestVector(){n=68, mode=6, input="4a71964b", output="7b7e12d2a520e232fde6c41dbbb2b8b74c2912fb3f15404f7304fe46691430c9"},
            new TestVector(){n=69, mode=6, input="e82f4188ab", output="f4bf0c76beee2abd6156b41afef4142c3dbabfede5b9ce2ecd282fb294669731"},
            new TestVector(){n=70, mode=6, input="8aa122803362", output="46bc101b681e53d49f4c1b5e42f496bd29b2b0f767c6e42bc4ac5ac317d9d41b"},
            new TestVector(){n=71, mode=6, input="c5f21a07c8dcc7", output="569b1a32fb32f1a7fc9e35baad586f35645c5366cdfdfed394076bcd1801371f"},
            new TestVector(){n=72, mode=6, input="587cb398fe82ffda", output="54f5dddb85f62dba7dc4727d502bdee959fb665bd482bd0ce31cbdd1a042e4b5"},
            new TestVector(){n=73, mode=6, input="127373351d8eb30829", output="dda6a905234e81b47780bb0834a760ecd297068b28d4e00faf2c5094ff869e72"}
        };
    }
}